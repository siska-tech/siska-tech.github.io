# Pure ONNX OCR WASM Demo

ブラウザ上で動作するPure ONNX OCRのデモアプリケーションです。

## セットアップ

### 1. WASMモジュールのビルド

```bash
# wasm-packをインストール（初回のみ）
cargo install wasm-pack

# WASMモジュールをビルド
wasm-pack build --target web --features wasm
```

これにより `pkg/` ディレクトリにWASMモジュールが生成されます。

### 2. モデルファイルの準備

デモはデフォルトでサーバーからモデルファイルを読み込みます。以下の2つの方法から選択できます：

#### 方法A: サーバーから読み込む（デフォルト・推奨）

デモページは起動時に自動的にサーバーからモデルファイルを読み込みます。
デフォルトパス: `../../tests/fixtures/models/ppocrv5/`

- `det.onnx` - DBNet検出モデル（4.5MB）
- `rec.onnx` - SVTR認識モデル（16MB）
- `ppocrv5_dict.txt` - 認識辞書（72KB）

**パスの変更方法：**
`index.js` の `loadModelsFromServer()` 関数内の `modelBasePath` を変更してください。

```javascript
const modelBasePath = '/your/custom/path/models';
```

#### 方法B: ファイルをアップロード

デモページの「モデル読み込み方法」で「ファイルをアップロード」を選択すると、
ユーザーが任意のモデルファイルをアップロードできます。

- モデルファイルは切り替え可能です
- 異なるバージョンのモデルを試すことができます

**注意：**
- アップロードしたモデルは、次回サーバーから読み込むまで保持されます
- モデルを切り替えるには、再度アップロードするか「サーバーから読み込む」に切り替えてください

### 3. サーバーの起動

ブラウザから直接ファイルを開くのではなく、HTTPサーバーを起動してください：

```bash
# Python 3の場合
python -m http.server 8000

# Node.jsの場合（http-serverが必要）
npx http-server -p 8000

# または他の静的ファイルサーバーを使用
```

### 4. ブラウザで開く

`http://localhost:8000/examples/wasm-demo/index.html` にアクセスしてください。

## 使用方法

1. **モデルファイルの読み込み**
   - 検出モデル（det.onnx）、認識モデル（rec.onnx）、辞書ファイル（ppocrv5_dict.txt）を選択します。

2. **画像の選択**
   - 画像ファイルを選択するか、ドラッグ＆ドロップでアップロードします。

3. **設定の調整（オプション）**
   - 検出最大辺長、検出拡大率、認識バッチサイズを調整できます。

4. **OCR実行**
   - 「OCR実行」ボタンをクリックして処理を開始します。

5. **結果の確認**
   - OCR結果が表示されます。コピーやダウンロードも可能です。

## 注意事項

- モデルファイルは初回読み込み時にメモリに保持されます。大きなモデルファイルの場合は、読み込みに時間がかかることがあります。
- WASMモジュールのビルドには時間がかかることがあります。
- ブラウザのメモリ制限により、大きな画像の処理ができない場合があります。

